# Execution Sequence

> Wave-based ordering derived from the dependency graph.
> Generated by: `python scripts/topological_sort.py`
> Validated by: `python scripts/validate_wave_completion.py`
>
> Tracks within the same wave are independent and can run in parallel.
> All tracks in a wave must complete before the next wave starts.

---

## Wave 1 — Foundation

| # | Track ID | Complexity | Description |
|---|----------|------------|-------------|
| 1 | 01_infra_scaffold | M | Docker Compose, CI/CD, project structure, shared libraries |
| 2 | 08_observability | S | OTel Collector, Grafana + Loki, structlog integration, base dashboards |

### Wave 1 Completion Criteria
- [ ] All phases in all wave tracks marked complete
- [ ] All track tests passing (`make test`)
- [ ] No BLOCKING discoveries in `architect/discovery/pending/`
- [ ] Docker Compose starts all base services (PostgreSQL, Redis, backend, frontend)
- [ ] OTel Collector receiving traces from backend health check endpoint
- [ ] `/healthz` and `/readyz` responding on backend service
- [ ] CI pipeline running successfully

---

## Wave 2 — Data & Events

| # | Track ID | Complexity | Description |
|---|----------|------------|-------------|
| 3 | 02_database_schema | M | PostgreSQL schema, Alembic migrations, seed data, connection pooling |
| 4 | 06_event_system | M | Celery + Redis broker, outbox relay, pub/sub, cache-aside, DLQ |

### Wave 2 Completion Criteria
- [ ] All phases in all wave tracks marked complete
- [ ] All track tests passing
- [ ] No BLOCKING discoveries in `architect/discovery/pending/`
- [ ] `alembic upgrade head` applies cleanly, `alembic downgrade base` rolls back
- [ ] Seed data populates all tables with representative data
- [ ] Celery worker starts and processes test tasks
- [ ] Outbox relay picks up and publishes events within 1 second
- [ ] All patches with `blocks_wave == 2` are COMPLETE

---

## Wave 3 — Core Services

| # | Track ID | Complexity | Description |
|---|----------|------------|-------------|
| 5 | 03_auth_system | L | JWT auth, RBAC middleware, password management, API key auth |
| 6 | 04_workflow_engine | XL | Execution state machine, step runner, retry, parallel/conditional, events |

### Wave 3 Completion Criteria
- [ ] All phases in all wave tracks marked complete
- [ ] All track tests passing
- [ ] No BLOCKING discoveries in `architect/discovery/pending/`
- [ ] Full auth flow works: register → login → access protected endpoint
- [ ] RBAC enforces role hierarchy correctly
- [ ] Linear, parallel, and conditional workflows execute to completion
- [ ] Failed steps retry per policy and mark run as failed after exhaustion
- [ ] All workflow state events appear in outbox and publish to Redis
- [ ] All patches with `blocks_wave == 3` are COMPLETE

---

## Wave 4 — Integration & UI

| # | Track ID | Complexity | Description |
|---|----------|------------|-------------|
| 7 | 05_api_layer | L | REST endpoints for workflows, runs, webhooks, templates |
| 8 | 07_react_frontend | XL | React UI, workflow builder (React Flow), run monitor, dashboard |

### Wave 4 Completion Criteria
- [ ] All phases in all wave tracks marked complete
- [ ] All track tests passing
- [ ] No BLOCKING discoveries in `architect/discovery/pending/`
- [ ] All API endpoints match interface contracts in interfaces.md
- [ ] Webhook ingestion accepts and triggers workflow execution
- [ ] React app renders all pages, workflow builder creates valid workflows
- [ ] Run monitoring shows live step-by-step status (polling)
- [ ] End-to-end flow works: create workflow in UI → trigger → monitor completion
- [ ] All patches with `blocks_wave == 4` are COMPLETE

---

## Progress Summary

| Wave | Tracks | Total Complexity | Status |
|------|--------|-----------------|--------|
| 1 | 2 | 3 (M+S) | NOT_STARTED |
| 2 | 2 | 4 (M+M) | NOT_STARTED |
| 3 | 2 | 7 (L+XL) | NOT_STARTED |
| 4 | 2 | 7 (L+XL) | NOT_STARTED |

Overall: 0/21 complexity-weighted units complete (0%)
